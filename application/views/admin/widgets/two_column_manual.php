<?php // widget config block Starts - This code block assign widget background colour, title and instance id. Do not delete it $widget_bg_color 		= $content['widget_bg_color'];$widget_custom_title 	= $content['widget_title'];$widget_instance_id 	= $content['widget_values']['data-widgetinstanceid'];$main_sction_id 		= "";$is_home 				= $content['is_home_page'];$is_summary_required 	= $content['widget_values']['cdata-showSummary'];$widget_section_url 	= $content['widget_section_url'];$view_mode            	= $content['mode'];$max_article            = $content['show_max_article'];$render_mode            = $content['RenderingMode'];// widget config block ends$widget_auto_count = $this->widget_model->select_setting($view_mode);$columnist_count   = $widget_auto_count['subsection_otherstories_count_perpage'];$max_article_count = $widget_auto_count['subsection_otherstories_autoCount'];$domain_name =  base_url();$show_simple_tab = "";$show_simple_tab .='<div class="row">					<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">					<div class="all_column" id="columns_'.$widget_instance_id.'" '.$widget_bg_color.'>';						if($render_mode == "manual"){	$content_type = $content['content_type_id'];  // manual article content type	$widget_instance_contents_pageination = $this->widget_model->get_widgetInstancearticles_rendering($widget_instance_id, " ", $view_mode, $max_article);}else{	$content_type = $content['content_type_id'];  // auto article content type	$widget_instance_contents_pageination = $this->widget_model->get_column_list_auto_totalcount($max_article, $content['sectionID'] , $content_type ,  $view_mode);}//print_r($widget_instance_contents_pageination); if (function_exists('array_column')) {	$get_content_ids = array_column($widget_instance_contents_pageination, 'content_id'); }else{	$get_content_ids = array_map( function($element) { return $element['content_id']; }, $widget_instance_contents);}$get_content_ids = implode("," ,$get_content_ids);/*$widget_contents_pagination = array();$content_id = '';if($get_content_ids!=''){	$widget_instance_article = $this->widget_model->get_contentdetails_from_database($get_content_ids, $content_type, $is_home, $view_mode);		$content_id = array();	foreach ($widget_instance_contents_pageination as $key => $value) {		foreach ($widget_instance_article as $key1 => $value1) {			if($value['content_id']==$value1['content_id']){			   $widget_contents_pagination[] = array_merge($value, $value1);			   $content_id[] = $value1['content_id'];			}		}	}	$content_id = implode("," ,$content_id);}*/$TotalCount= count($widget_instance_contents_pageination); $last_content_id = @$widget_instance_contents_pageination[$TotalCount-1]['content_id'];// Pagination start											$this->load->library('pagination');$config['total_rows'] = $TotalCount; $config['per_page'] = $columnist_count; $config['custom_num_links'] = 5;$config['page_query_string'] = TRUE;$config['enable_query_strings']=TRUE;$config['use_page_numbers'] = TRUE;$config['cur_tag_open'] = "<a href='javascript:void(0);' class='active'>";$config['cur_tag_close'] = "</a>";$page_num = $config['use_page_numbers'];$columnist_limit = ($this->input->get('per_page') != '')?$this->input->get('per_page'):0;$start = $columnist_limit; $page_number = $this->input->get('per_page')/$config['per_page'] + 1 ;$limit = $columnist_count;$config['use_page_numbers'] = TRUE;//$offset = $this->uri->segment(4);$this->pagination->initialize($config); //$PaginationLink = $this->pagination->create_links();$PaginationLink = $this->pagination->custom_create_links();$load_more_url = $domain_name.'topic/?sid='.$content['page_param'].'&cid=1';// pagination end	$archive =  '';/* if($get_content_ids!=''){ */	//$widget_instance_contents1 = $this->widget_model->get_contentdetails_from_database($get_content_ids, $content_type, $is_home, $view_mode);		$widget_instance_contents1 = $this->widget_model->get_contentdetails_from_database_per_page($get_content_ids, $content_type, $is_home, $view_mode, $start,$limit, '');		$widget_contents = array();	foreach ($widget_instance_contents_pageination as $key => $value) {		foreach ($widget_instance_contents1 as $key1 => $value1) {			if($value['content_id']==$value1['content_id']){			   $widget_contents[] = array_merge($value, $value1);			}		}	}$show_simple_tab = "";$url=base_url($widget_custom_title);$custom_title=($widget_custom_title=='')?'More Tech Stories':'More '.$widget_custom_title.' Stories';$show_simple_tab .=' <div class="row"><div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 margin-bottom-15"><div class="HealthLast WidthFloat_L"><fieldset class="FieldTopic"><legend class="topic"><a href="'.$url.'">'.$widget_custom_title.'</a></legend></fieldset>';$archive =  '';if(count($widget_contents) > 0){	$i =1;		$manual_instance = "&instance=archive";	$load_more_url = $domain_name.'topic/?sid='.$content['page_param'].'&cid=1'.$manual_instance;	$count = 1;		// content list iteration block - Looping through content list and adding it the list	// content list iteration block starts here	foreach($widget_contents as $key_value => $get_content)	{		//$content_details = $this->widget_model->get_contentdetails_from_database($get_content['content_id'], $content_type, $is_home, $view_mode);			$original_image_path = "";		$imagealt            = "";		$imagetitle          = "";		$Image600X390        = "";		if($original_image_path =='')		{			if($get_content['ImagePhysicalPath'] !='')			{				$original_image_path  = $get_content['ImagePhysicalPath'];				$imagealt             = $get_content['ImageCaption'];					$imagetitle           = $get_content['ImageAlt'];				}			}				//$SourceURL = $content['widget_img_phy_path'];		$show_image="";		if($original_image_path !='' && get_image_source($original_image_path, 1))		{			$imagedetails = get_image_source($original_image_path, 2);			$imagewidth = $imagedetails[0];			$imageheight = $imagedetails[1];						if ($imageheight > $imagewidth)			{				$Image600X390 	= $original_image_path;			}			else			{			   $Image600X390  = str_replace("original","w600X390", $original_image_path);			}			if (get_image_source($Image600X390, 1) && $Image600X390 != '')			{				$show_image = image_url. imagelibrary_image_path . $Image600X390;			}			else			{				$show_image	= image_url. imagelibrary_image_path.'logo/nie_logo_600X390.jpg';			}			}		else		{			$show_image	  = image_url. imagelibrary_image_path.'logo/nie_logo_600X390.jpg';		}		$dummy_image  = image_url. imagelibrary_image_path.'logo/nie_logo_600X390.jpg';				$content_url = $get_content['url'];		$param = $content['close_param'];		$live_article_url = $domain_name.$content_url.$param;				$custom_title = $get_content['title'];		$lastpublishedon = $get_content['publish_start_date'];		$display_title = preg_replace('/<p[^>]*>(.*)<\/p[^>]*>/i', '$1',$custom_title);   //to remove first<p> and last</p>  tag		$display_title = '<a  href="'.$live_article_url.'" class="article_click" >'.$display_title.'</a>';				$summary =  $get_content['summary_html'];		$summary  = preg_replace('/<p[^>]*>(.*)<\/p[^>]*>/i', '$1',$summary);					if(trim($summary) == '') {			$bodycontent = trim(strip_tags($get_content['article_page_content_html']));			$headline_position = strpos($bodycontent, ":");						if($headline_position < 50) {			$bodycontent = substr($bodycontent, $headline_position + 1);  			}			$summary  = character_limiter($bodycontent,150);		}		$time= $lastpublishedon;		$post_time= $this->widget_model->time2string($time);						if(($i%2)==0):			//added for first slot			$show_simple_tab .='<div class="row">';			$show_simple_tab .='<div class="col-lg-4 col-md-4 col-sm-4 col-xs-12 health-bottom">';			$show_simple_tab .='<h4 class="subtopic_center">'.$display_title.'</h4>';			$show_simple_tab .='<div class="line_wrap">';			$show_simple_tab .='<div class="line_inside"></div></div>';			$show_simple_tab .='<p class="para_center">'.stripslashes($summary).'</p>';			$show_simple_tab .='<div class="pub_art"><div class="pub_on">Published On:</div> <div class="pub_date">'.$post_time.'</div>';			$show_simple_tab .='</div></div><div class="col-lg-1 col-md-1 col-sm-1 col-xs-12 health-bottom"></div>';			$show_simple_tab .='<div class="col-lg-7 col-md-7 col-sm-7 col-xs-12 health-bottom">';			$show_simple_tab .='<div class="vid_im"><img src="'.$show_image.'" alt="'.$imagealt.'"  title = "'.$imagetitle.'" class="grayscale"></div></div>';  		else:			//added for second slot			$show_simple_tab .='<div class="row">';			$show_simple_tab .='<div class="col-lg-7 col-md-7 col-sm-7 col-xs-12 health-bottom">';			$show_simple_tab .='<div class="vid_im"><img src="'.$show_image.'" alt="'.$imagealt.'"  title = "'.$imagetitle.'" class="grayscale"></div>';			$show_simple_tab .='</div>';			$show_simple_tab .='<div class="col-lg-1 col-md-1 col-sm-1 col-xs-12 health-bottom"></div>';			$show_simple_tab .='<div class="col-lg-4 col-md-4 col-sm-4 col-xs-12 health-bottom">';			$show_simple_tab .='<h4 class="subtopic_center">'.$display_title.'</h4>';			$show_simple_tab .='<div class="line_wrap"><div class="line_inside"></div></div>';			$show_simple_tab .='<p class="para_center">'.stripslashes($summary).'</p>';			$show_simple_tab .='<div class="pub_art"><div class="pub_on">Published On:</div>';			$show_simple_tab .='<div class="pub_date">'.$post_time.'</div>';			$show_simple_tab .='</div></div>';                                                			$show_simple_tab .='</div>';          		endif;				$i =$i+1;		}// content list iteration block ends here	} elseif($view_mode=="adminview"){  $show_simple_tab .='<div class="margin-bottom-10">'.no_articles.'</div>';}$show_simple_tab .='</div></div>';$show_simple_tab .='<div class="pagina">';$show_simple_tab .= $PaginationLink ;$show_simple_tab .=$archive.'</div></div></div>';echo $show_simple_tab;?>